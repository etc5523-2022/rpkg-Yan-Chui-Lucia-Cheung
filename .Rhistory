} else {
print("This is not a popular name of this year!")
}
}
name_of_the_year("h", "2018")
name_of_the_year("Lucy", "2018")
usethis::use_data(seattle_pets, overwrite = TRUE)
usethis::use_test()
usethis::use_test()
library(dplyr)
library(magrittr)
library(readr)
library(ggplot2)
library(plotly)
library(stringr)
library(lubridate)
seattle_pets <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-03-26/seattle_pets.csv") %>%
filter(!is.na(zip_code)) %>%
mutate(zip_code = str_remove_all(zip_code, "(-)[0-9]{4}")) %>%
mutate(zip_code = as.integer(zip_code)) %>%
mutate(license_issue_date = as_date(license_issue_date, format = "%B %d %Y"))
max_pribreed <- function(pri_breed) {
primary_breed <- zip_code <- n <- count <- NULL
max_pribreed <- seattle_pets %>%
dplyr::filter(primary_breed == pri_breed) %>%
dplyr::group_by(zip_code) %>%
dplyr::summarize(count = n()) %>%
dplyr::arrange(-count) %>%
utils::head(5)
base::print(max_pribreed)
}
zipcode_max <- function(max_year) {
license_issue_date <- year <- zip_code <- n <- NULL
max <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::group_by(year, zip_code) %>%
dplyr::count() %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
dplyr::group_by(year) %>%
dplyr::slice(base::which.max(n)) %>%
dplyr::filter(year == max_year)
base::print(max)
}
zipcode_min <- function(min_year) {
license_issue_date <- year <- zip_code <- n <- NULL
min <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::group_by(year, zip_code) %>%
dplyr::count() %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
dplyr::group_by(year) %>%
dplyr::slice(base::which.min(n)) %>%
dplyr::filter(year == min_year)
base::print(min)
}
name_of_the_year <- function(pet_name, top_year) {
license_issue_date <- year <- animals_name <- n <- NULL
name <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
dplyr::filter(!is.na(animals_name)) %>%
dplyr::group_by(year, animals_name) %>%
dplyr::count() %>%
dplyr::filter(year == top_year) %>%
dplyr::arrange(-n) %>%
utils::head(5)
if(base::any(name$animals_name %in% pet_name)) {
base::print("This is a popular name of this year!")
base::print(name)
} else {
base::print("This is not a popular name of this year!")
}
}
top_name <- function(pet_type) {
animals_name <- species <- n <- NULL
plot <- seattle_pets %>%
dplyr::filter(!base::is.na(animals_name)) %>%
dplyr::filter(species == pet_type)%>%
dplyr::group_by(animals_name) %>%
dplyr::count() %>%
dplyr::arrange(-n) %>%
utils::head(10) %>%
ggplot2::ggplot(ggplot2::aes(x = stats::reorder(animals_name, -n), y = n,
text = base::paste("name: ", stats::reorder(animals_name, -n), "count: ", n))) +
ggplot2::geom_col(fill = "light blue")+
ggplot2::xlab("pet names") +
ggplot2::ylab("number of pet")
plotly::ggplotly(plot, tooltip = "text")
}
devtools::test_active_file()
rm(list = c("max_pribreed", "name_of_the_year", "top_name", "zipcode_max",
"zipcode_min"))
devtools::test_active_file()
devtools::test_active_file()
devtools::test_active_file()
devtools::test_active_file()
devtools::test_active_file()
View(seattle_pets)
devtools::load_all("Dog")
devtools::load_all()
library(seattlepetname)
top_name("Dog")
pet_type <- unique(seattle_pets$species)
seattle_pets <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-03-26/seattle_pets.csv") %>%
filter(!is.na(zip_code)) %>%
mutate(zip_code = str_remove_all(zip_code, "(-)[0-9]{4}")) %>%
mutate(zip_code = as.integer(zip_code)) %>%
mutate(license_issue_date = as_date(license_issue_date, format = "%B %d %Y"))
devtools::test_active_file()
unique(seattle_pets$species)
devtools::test_active_file()
devtools::test_active_file()
plotly
devtools::test_active_file()
devtools::test_active_file()
devtools::test_active_file()
devtools::test_active_file()
devtools::test_active_file()
devtools::test_active_file()
devtools::test_active_file()
devtools::test_active_file()
test_that("testing zipcode_min function", {
pet_name <- c("Gingersnap")
top_year <- c("2018")
expect_true(name_of_the_year(pet_name, top_year), "data.frame", "character")
})
test_that("testing zipcode_min function", {
pet_name <- c("Gingersnap")
top_year <- c("2018")
expect_type(name_of_the_year(pet_name, top_year), "data.frame", "character")
})
test_that("testing zipcode_min function", {
pet_name <- c("Gingersnap")
top_year <- c("2018")
expect_type(name_of_the_year(pet_name, top_year), "data.frame")
})
test_that("testing zipcode_min function", {
pet_name <- c("Gingersnap")
top_year <- c("2018")
expect_type(name_of_the_year(pet_name, top_year), "character")
})
test_that("testing top_name function", {
pet_type <- c("Cat")
expect_s3_class(top_name(pet_type), "plotly")
})
test_that("testing max_pribreed function", {
pri_breed <- c("Terrier, Jack Russell")
expect_s3_class(max_pribreed(pri_breed), "data.frame")
})
test_that("testing zipcode_max function", {
max_year <- c("2015")
expect_s3_class(zipcode_max(max_year), "data.frame")
})
test_that("testing zipcode_min function", {
pet_name <- c("Gingersnap")
top_year <- c("2018")
expect_type(name_of_the_year(pet_name, top_year), "character")
})
numerical_summary <- seattle_pets %>%
group_by(year, zipcode) %>%
summarise(count = count())
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
group_by(year, zipcode) %>%
summarise(count = count())
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
group_by(year, zip_code) %>%
summarise(count = count())
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
group_by(year, zip_code) %>%
count()
View(numerical_summary)
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count()
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year, zip_code) %>%
summarise(mean = mean(n))
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year, zip_code) %>%
summarise(max = max(n))
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year, zip_code) %>%
summarise(mean = mean(n), .groups = "drop")
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year, zip_code) %>%
summarise(mean = mean(n), median = median(n))
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year, zip_code) %>%
summarise(mean = mean(n), median = median(n), .groups = "drop")
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year) %>%
summarise(mean = mean(n), median = median(n), .groups = "drop")
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year) %>%
summarise(mean = mean(n), median = median(n))
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year) %>%
count() %>%
summarise(mean = mean(n), median = median(n))
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year) %>%
count()
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year) %>%
count() %>%
summarise(mean = mean(n), median = median(n))
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year) %>%
count() %>%
group_by(year) %>%
summarise(mean = mean(n), median = median(n))
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count()
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count()
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year) %>%
summarise(mean = mean(n), median = median(n))
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count()
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year, zip_code) %>%
mutate(min = min(n), max = max(n))
numerical_summary <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year, zip_code) %>%
mutate(min = which.min(n), which.max = max(n))
mean <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year) %>%
summarise(mean = mean(n), median = median(n), sd = sd(n))
View(mean)
mean <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year) %>%
mutate(mean = round(mean(n), 2),
median = round(median(n), 2), sd = round(sd(n), 2),
count_zipcode = count(zip_code))
mean <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year) %>%
summarise(mean = round(mean(n), 2),
median = round(median(n), 2), sd = round(sd(n), 2))
cleanned_data <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014"))
summary <- cleanned_data %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year) %>%
summarise(mean = round(mean(n), 2),
median = round(median(n), 2), sd = round(sd(n), 2))
View(summary)
count_zipcode <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year, zip_code) %>%
summarise(count = count(zip_code))
count_zipcode <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
group_by(year) %>%
summarise(count = count(zip_code))
count_zipcode <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
mutate(zip_code = as.numeric(zip_code)) %>%
group_by(year) %>%
summarise(count = count(zip_code))
count_zipcode <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
mutate(zip_code = as.numeric(zip_code))
View(count_zipcode)
count_zipcode <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
mutate(zip_code = as.numeric(zip_code)) %>%
group_by(year) %>%
mutate(count = count(zip_code))
count_zipcode <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
mutate(zip_code = as.numeric(zip_code)) %>%
group_by(year, zip_code) %>%
mutate(count = count(zip_code))
count_zipcode <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
mutate(zip_code = as.numeric(zip_code)) %>%
group_by(year, zip_code) %>%
count()
count_zipcode <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014")) %>%
mutate(zip_code = as.numeric(zip_code)) %>%
group_by(year, zip_code) %>%
count() %>%
distinct(zip_code)
count_zipcode <-  cleanned_data %>%
mutate(zip_code = as.numeric(zip_code)) %>%
group_by(year, zip_code) %>%
distinct(zip_code)
count_zipcode <-  cleanned_data %>%
mutate(zip_code = as.numeric(zip_code)) %>%
group_by(year, zip_code) %>%
distinct(zip_code) %>%
count()
count_zipcode <-  cleanned_data %>%
mutate(zip_code = as.numeric(zip_code)) %>%
group_by(year, zip_code) %>%
distinct(zip_code) %>%
group_by(year) %>%
count()
count_zipcode <-  cleanned_data %>%
mutate(zip_code = as.numeric(zip_code)) %>%
group_by(year, zip_code) %>%
distinct(zip_code) %>%
group_by(year) %>%
count() %>%
select(year, zip_code)
count_zipcode <-  cleanned_data %>%
mutate(zip_code = as.numeric(zip_code)) %>%
group_by(year, zip_code) %>%
distinct(zip_code) %>%
group_by(year) %>%
count() %>%
rename(zipcode_count = n)
year_summary <- full_join(summary, count_zipcode, by = year)
year_summary <- full_join(summary, count_zipcode, by = "year")
View(year_summary)
pet_summary <- function(pet_count) {
cleanned_data <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014"))
summary <- cleanned_data %>%
group_by(year, zip_code) %>%
count() %>%
group_by(year) %>%
summarise(mean = round(mean(n), 2),
median = round(median(n), 2), sd = round(sd(n), 2))
count_zipcode <-  cleanned_data %>%
mutate(zip_code = as.numeric(zip_code)) %>%
group_by(year, zip_code) %>%
distinct(zip_code) %>%
group_by(year) %>%
count() %>%
rename(zipcode_count = n)
year_summary <- full_join(summary, count_zipcode, by = "year") %>%
filter(year == pet_count)
print(year_summary)
}
pet_summary("2015")
test_that("testing pet_summary function", {
pet_count <- c("2015")
expect_s3_class(pet_summary(pet_count), "data.frame")
})
usethis::use_package_doc()
usethis::use_vignette("vignette-name")
usethis::use_vignette(name = "seattle-pet-name", title = "Seattle pet name and distribution")
library(seattlepetname)
library(seattlepetname)
seattle_pets <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-03-26/seattle_pets.csv") %>%
filter(!is.na(zip_code)) %>%
mutate(zip_code = str_remove_all(zip_code, "(-)[0-9]{4}")) %>%
mutate(zip_code = as.integer(zip_code)) %>%
mutate(license_issue_date = as_date(license_issue_date, format = "%B %d %Y"))
library(dplyr)
library(magrittr)
library(readr)
library(ggplot2)
library(plotly)
library(stringr)
library(lubridate)
seattle_pets <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-03-26/seattle_pets.csv") %>%
filter(!is.na(zip_code)) %>%
mutate(zip_code = str_remove_all(zip_code, "(-)[0-9]{4}")) %>%
mutate(zip_code = as.integer(zip_code)) %>%
mutate(license_issue_date = as_date(license_issue_date, format = "%B %d %Y"))
View(seattle_pets)
max_pribreed("Old English Sheepdog")
zipcode_max("2018")
library(seattlepetname)
zipcode_max("2018")
seattlepetname::zipcode_max("2018")
zipcode_max("2018")
seattlepetname::zipcode_max("2018")
seattlepetname::zipcode_min("2018")
seattlepetname::top_name("2018")
pet_summary("2018")
devtools::load_all()
top_name("2018")
zipcode_max("2018")
zipcode_min("2018")
zipcode_min("2018")
zipcode_max("2018")
zipcode_min("2018")
name_of_the_year("Silas", "2018")
pet_summary("Dog")
top_name("Dog")
name_of_the_year("Lucy", "2018")
name_of_the_year("o", "2018")
name_of_the_year("Silas", "2018")
pet_summary("2018")
cleanned_data %>%
dplyr::group_by(year, zip_code) %>%
dplyr::count() %>%
dplyr::group_by(year) %>%
cleanned_data %>%
dplyr::group_by(year, zip_code) %>%
dplyr::count() %>%
dplyr::group_by(year) %>%
summarise(sum = sum(n))
cleanned_data <- seattle_pets %>%
dplyr::mutate(year = lubridate::year(license_issue_date)) %>%
dplyr::filter(!year %in% c("2003", "2004", "2006", "2008", "2011", "2012", "2014"))
cleanned_data %>%
dplyr::group_by(year, zip_code) %>%
dplyr::count() %>%
dplyr::group_by(year) %>%
summarise(sum = sum(n))
top_name("Dog")
usethis::use_git()
added vignette
'Initial commit'
usethis::use_git()
devtools::install_github("Yan-Chui-Lucia-Cheung/rpkg-Yan-Chui-Lucia-Cheung")
git remote add origin https://github.com/etc5523-2022/rpkg-Yan-Chui-Lucia-Cheung.git
devtools::install_github("Yan-Chui-Lucia-Cheung/rpkg-Yan-Chui-Lucia-Cheung")
devtools::install_github("Yan-Chui-Lucia-Cheung/rpkg-Yan-Chui-Lucia-Cheung")
devtools::install_github("etc5523-2022/rpkg-Yan-Chui-Lucia-Cheung")
usethis::use_github()
devtools::install_github("Yan-Chui-Lucia-Cheung/rpkg-Yan-Chui-Lucia-Cheung")
devtools::install()
library(seattlepetname)
zipcode_max("2018")
devtools::build()
devtools::install()
library(seattlepetname)
